<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:sec="http://www.springframework.org/security/tags"
	xmlns:custom="http://myagile.com/custom">
	<style>
.test {
	position: relative;
}
</style>

	<p:panel id="setting-form" style="display:none;"
		header="Kanban Setting">
		<h:form id="setting-kanban" style="margin-bottom: 2px;">
		<div style="text-align:center;width:100%;">
			<h:panelGroup>
				<p:commandButton id="addMoreField" value="Add More Field"
					global="false" action="#{kanbanBean.handleAddField}"
					update=":setting-kanban" />
				<h:outputText value="&#160;" />
				<p:commandButton id="addMoreSwimLine" value="Add More Swimline"
					update=":setting-kanban" global="false"
					action="#{kanbanBean.handleAddSwimline}" />
			</h:panelGroup>
	</div>
			<p:scrollPanel
				style="height:250px;margin-top:10px;margin-bottom:10px; padding-right:10px;"
				mode="native">
				<p:remoteCommand name="deleteColumn"
					action="#{kanbanBean.removeStatus}" update=":setting-kanban"
					global="false" immediate="true"></p:remoteCommand>
			Field
			<p:separator style="margin-bottom:10px;margin-top:0px" />

				<ui:repeat var="status" value="#{kanbanBean.kanbanStatusTempList}"
					varStatus="loop">
					<h:panelGroup rendered="#{status.type=='START'}">
						<div class="form-inline">
							<p:inputText value="#{status.name}" required="true"
								requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}"
								maxlength="30">
							</p:inputText>
							<label>Width (%)</label>
							<span class="mySpinner widthSpinner">
								<p:spinner value="#{status.width}" validator="#{kanbanBean.validateValue}" required="true"
									immediate="true" min="10" max="50" requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}">
									<f:validateDoubleRange minimum="10" maximum="50"></f:validateDoubleRange>
								</p:spinner>
							</span>
							<p:selectBooleanCheckbox value="#{status.columnDone}"
								itemLabel="Done">
							</p:selectBooleanCheckbox>

							<label>WIP</label>
					<span class="mySpinner">
							<p:spinner size="2"   value="#{status.weightPoint}"
										validator="#{kanbanBean.validateValue}" required="true"
										immediate="true" min="1" max="20" requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}">
										<f:validateDoubleRange minimum="1" maximum="20">
								</f:validateDoubleRange>
									</p:spinner>
								</span>

							<div style="float: right;">
								<p:colorPicker value="#{status.color}" />
								<p:commandButton type="button" style="visibility: hidden;"
									icon="icon-remove" update=":setting-kanban" immediate="true"
									global="false">
								</p:commandButton>
							</div>
						</div>

					</h:panelGroup>

					<h:panelGroup rendered="#{status.type=='IN_PROGRESS'}">
						<div class="form-inline">
							<p:inputText value="#{status.name}" required="true"
								requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}"
								maxlength="30">
							</p:inputText>
							<label>Width (%)</label>
							<span class="mySpinner widthSpinner">
								<p:spinner value="#{status.width}" validator="#{kanbanBean.validateValue}" required="true"
									immediate="true" min="10" max="50" requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}">
									<f:validateDoubleRange minimum="10" maximum="50"></f:validateDoubleRange>
								</p:spinner>
							</span>
							<p:selectBooleanCheckbox value="#{status.columnDone}"
								itemLabel="Done">
							</p:selectBooleanCheckbox>

							<label>WIP</label>
								<span class="mySpinner">
							<p:spinner size="2"   value="#{status.weightPoint}"
										validator="#{kanbanBean.validateValue}" required="true"
										immediate="true" min="1" max="20" requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}">
										<f:validateDoubleRange minimum="1" maximum="20">
								</f:validateDoubleRange>
									</p:spinner>
								</span>
							
							
							
							<div style="float: right;">
								<p:colorPicker value="#{status.color}" />
								<p:commandButton type="button" icon="icon-remove"
									update=":setting-kanban"
									rendered="#{status.type=='IN_PROGRESS' and custom:isUserInAnyRoles('DEVELOPER,SCRUM_MASTER,PRODUCT_OWNER', kanbanBean.currentTeam.teamId)}"
									immediate="true" global="false"
									onclick="deleteColumn([{name: 'statusId', value: '#{status.statusId}'}])">
								</p:commandButton>
							</div>
						</div>

					</h:panelGroup>

					<h:panelGroup rendered="#{status.type=='DONE'}">
						<div class="form-inline">
							<p:inputText value="#{status.name}" required="true"
								requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}"
								maxlength="30">
							</p:inputText>
							<label>Width (%)</label>
							<span class="mySpinner widthSpinner">
								<p:spinner value="#{status.width}" validator="#{kanbanBean.validateValue}" required="true"
									immediate="true" min="10" max="50" requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}">
									<f:validateDoubleRange minimum="10" maximum="50"></f:validateDoubleRange>
								</p:spinner>
							</span>
							<div style="float: right;">
								<p:colorPicker value="#{status.color}" />
								<p:commandButton type="button" style="visibility: hidden;"
									icon="icon-remove" update=":setting-kanban" immediate="true"
									global="false">
								</p:commandButton>
							</div>
						</div>

					</h:panelGroup>

					<h:panelGroup rendered="#{status.type=='ACCEPTED_HIDE'}">
						<div class="form-inline">
							<p:inputText value="#{status.name}"
								styleClass="acceptedStatusText" required="true"
								requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}"
								maxlength="30">
							</p:inputText>
							<label>Width (%)</label>
							<span class="mySpinner widthSpinner">
								<p:spinner value="#{status.width}" validator="#{kanbanBean.validateValue}" required="true"
									immediate="true" min="10" max="50" requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}">
									<f:validateDoubleRange minimum="10" maximum="50"></f:validateDoubleRange>
								</p:spinner>
							</span>
							<label>Disappear After</label>
							<div style="float: right;" >
							<span class="fixColorPicker">
								<p:colorPicker  style="width: 40px;"  value="#{status.color}" />
							</span>
									<button
										class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only"
										onclick="toggleShowAcceptedStatus(this)" type="button">
										<span class="ui-button-icon-left ui-icon ui-c icon-eye-close"></span><span
											class="ui-button-text ui-c">ui-button</span>
									</button>
						
								<p:selectBooleanCheckbox widgetVar="showAcceptedStatus"
									style="display: none" immediate="true" global="false"
									value="#{kanbanBean.showAcceptedStatus}">
								</p:selectBooleanCheckbox>
								<script>
									$('.acceptedStatusText').prop('disabled', true);
								</script>
							</div>
						</div>
					</h:panelGroup>
					<h:panelGroup rendered="#{status.type=='ACCEPTED_SHOW'}">
						<div class="form-inline">
							<p:inputText value="#{status.name}"
								id="status_name_#{status.statusId}"
								styleClass="acceptedStatusText" required="true"
								requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}"
								maxlength="30">
							</p:inputText>
							<label>Width (%)</label>
							<span class="mySpinner widthSpinner">
								<p:spinner value="#{status.width}" validator="#{kanbanBean.validateValue}" required="true"
									immediate="true" min="10" max="50" requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}">
									<f:validateDoubleRange minimum="10" maximum="50"></f:validateDoubleRange>
								</p:spinner>
							</span>
							<p:selectBooleanCheckbox widgetVar="showAcceptedStatus" style="display: none"
						 immediate="true" global="false" value="#{kanbanBean.showAcceptedStatus}">
					</p:selectBooleanCheckbox>
							<div style="float: right;" class="fixColorPicker">
								<p:colorPicker  value="#{status.color}" />
								<button
									class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only"
									onclick="toggleShowAcceptedStatus(this)" type="button">
									<span class="ui-button-icon-left ui-icon ui-c icon-eye-open"></span><span
										class="ui-button-text ui-c">ui-button</span>
								</button>

								<p:commandButton type="button" icon="icon-remove"
									update=":setting-kanban"
									rendered="#{status.type=='IN_PROGRESS' and custom:isUserInAnyRoles('DEVELOPER,SCRUM_MASTER,PRODUCT_OWNER', kanbanBean.currentTeam.teamId)}"
									immediate="true" global="false"
									onclick="deleteColumn([{name: 'statusId', value: '#{status.statusId}'}])">
								</p:commandButton>

							</div>
						</div>
					</h:panelGroup>

				</ui:repeat>
			
			Swimline
			<p:separator style="margin-bottom:10px;margin-top:0px" />
				<p:remoteCommand name="deleteSwimline"
					action="#{kanbanBean.removeSwimline}" update=":setting-kanban"
					global="false" immediate="true"></p:remoteCommand>
				<ui:repeat var="swimline" value="#{kanbanBean.kanbanSwimlinesTemp}"
					varStatus="loopIndex">
					<div class="form-inline">
						<p:inputText value="#{swimline.name}"
							id="swimline_name_#{swimline.swimlineId}"
							 required="true"
							requiredMessage="#{msg['myagile.dashboard.ErrorEmptyField']}"
							maxlength="30">
						</p:inputText>

						<div style="float: right;">
							<p:colorPicker value="#{swimline.color}" />

							<h:panelGroup rendered="#{loopIndex.index==0}">
								<p:commandButton type="button" style="visibility: hidden;"
									icon="icon-remove" update=":setting-kanban" immediate="true"
									global="false">
								</p:commandButton>
							</h:panelGroup>

							<h:panelGroup rendered="#{loopIndex.index!=0}">
								<p:commandButton type="button" icon="icon-remove"
									update=":setting-kanban"
									rendered="#{custom:isUserInAnyRoles('DEVELOPER,SCRUM_MASTER,PRODUCT_OWNER', kanbanBean.currentTeam.teamId)}"
									immediate="true" global="false"
									onclick="deleteSwimline([{name: 'swimlineId', value: '#{swimline.swimlineId}'}])">
								</p:commandButton>
							</h:panelGroup>
						</div>

					</div>
				</ui:repeat>
			</p:scrollPanel>
	<div style="text-align:center;width:100%;">
			<p:commandButton id="saveBtn" value="Save"
				action="#{kanbanBean.handleSaveSettingForm}"
				update=":setting-kanban, @(.kanban_wrapper),:form-kanban"
				oncomplete="handleSaveRequestFormSetting(xhr, status, args)" />
			<h:outputText value="&#160;" />
			<p:commandButton id="closeBtn" value="Close" global="false"
				styleClass="secondary" onclick="hideSettingForm()" />
				</div>
		</h:form>
	</p:panel>
</ui:composition>